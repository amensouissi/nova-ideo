<div tal:replace="structure navbar_body"/>
<div class="media user-media" i18n:domain="novaideo">
  <div class="media-left">
    <img class="img-thumbnail" tal:condition="user.picture is not None" tal:attributes="src getattr(user.picture, 'profil', user.picture).url" />
    <img class="img-thumbnail" tal:condition="user.picture is None" src="${request.static_url('novaideo:static/images/user.png')}" />
  </div>
  <div class="media-body">
    <h3 class="media-heading">
        <strong>${getattr(user, 'title', user.name)}</strong>
    </h3>
    <div class="user-function" tal:condition="getattr(user, 'function', '')">${user.function}</div>
    <dl class="dl-horizontal dl-left">
        <dt i18n:translate="">Member since</dt>
        <dd><span tal:replace="layout.to_localized_time(user.created_at, date_only=True)"/></dd>
        <dt tal:condition="is_portal_manager" i18n:translate="">Email</dt>
        <dd tal:condition="is_portal_manager" tal:define="mail getattr(user, 'email', '')">
          <a href="mailto:${mail}">${mail}</a>
        </dd>
        <dt tal:condition="getattr(user, 'organization', None)" i18n:translate="">Organization</dt>
        <dd tal:condition="getattr(user, 'organization', None)">
           <a tal:attributes="href request.resource_url(user.organization, '@@index')">${user.organization.title}</a>
        </dd>
        <dt i18n:translate="">Preferences</dt>
        <dd tal:condition="getattr(user, 'keywords', [])">
          <tal:loop repeat="k user.keywords">
            <a tal:attributes="href request.resource_url(request.root, '', query={'text_to_search':k})">${k}</a><tal:separator condition="not: repeat['k'].end">, </tal:separator> 
          </tal:loop>
        </dd>
        <dd tal:condition="not getattr(user, 'keywords', [])" i18n:translate="">No preferences</dd>
        <dt tal:condition="is_portal_manager and getattr(user, 'last_connection', None)" i18n:translate="">Last connection</dt>
        <dd tal:condition="is_portal_manager and getattr(user, 'last_connection', None)">
          <span tal:replace="layout.to_localized_time(user.last_connection)"/>
        </dd>
    </dl>
  </div>
</div>
<div class="user-description" tal:condition="getattr(user, 'description', '')">${user.description}</div>
<h4 tal:condition="len_contents" id="contents" class="section-title" i18n:domain="novaideo">
  <span class="icon glyphicon glyphicon-th"></span> 
  <span i18n:translate="">Contribution</span> 
  <span class="pull-right badge hidden-xs">${len_contents} 
    <span tal:condition="len_contents > 1" i18n:translate="">contents</span>
    <span tal:condition="len_contents == 1" i18n:translate="">content</span>
  </span>
</h4>
<div tal:condition="len_contents">
  ${structure:contents}
</div>
<div tal:replace="structure footer_body"/>
${panel('social_share_toggle')}