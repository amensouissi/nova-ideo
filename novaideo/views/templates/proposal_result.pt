<div class="thumbnail right-caption span4 search-item result-item"  
     i18n:domain="novaideo"
     tal:define="url request.resource_url(object, '@@index');
                 icon getattr(object, 'icon')">
  <div id="proposal-image" class="content-image">
    <a href="${url}"><span class="hidden-xs icon ${icon}"></span></a>
  </div>
  <div class="media-body">
    <a href="${url}"><h4 tal:condition="state"><span class="label label-basic pull-right" i18n:translate="" tal:content="state"/></h4></a>
    <a tal:attributes="href url"><h3><span class="visible-xs-inline-block icon ${icon}"></span>  ${object.title}</h3></a>
    <dl i18n:domain="novaideo">
      <dt i18n:translate="">Abstract</dt><dd>${object.presentation_text(400)}</dd>
      <dt tal:condition="object.keywords"  i18n:translate="">Keywords</dt>
      <dd tal:condition="object.keywords">
        <tal:loop repeat="k object.keywords">
          <a tal:attributes="href request.resource_url(request.root, '', query={'text_to_search':k})">${k}</a>
            <tal:separator condition="not: repeat['k'].end">, </tal:separator> 
        </tal:loop>
      </dd>
      <dt class=""><span i18n:translate="">Working group</span> <span class="working-group-toggle glyphicon glyphicon-chevron-down"></span></dt>
      <dd class="working-group-section hide-bloc">
        <tal:loop repeat="m object.working_group.members">
          <a tal:attributes="href request.resource_url(m, '@@index')">${getattr(m, 'title', m.name)}</a>
            <tal:separator condition="not: repeat['m'].end">, </tal:separator> 
       </tal:loop>
      </dd>
    </dl>
    <span tal:condition="(object.version is None or not object.working_group) and not object.corrections">
      <span  i18n:translate="">Modify the</span> <span tal:replace="layout.to_localized_time(object.modified_at, date_only=True)"/> <span  i18n:translate="">at</span> ${object.modified_at.hour}:${object.modified_at.minute}:${object.modified_at.second} <span i18n:translate="">by</span> <a tal:attributes="href request.resource_url(object.author, '@@index')">${((object.author is current_user) and 'Vous') or object.author.name}</a>
    </span>

    <span tal:condition="(object.version or object.corrections) and object.working_group">
      <span  i18n:translate="">Modify the</span> <span tal:replace="layout.to_localized_time(object.modified_at, date_only=True)"/> <span  i18n:translate="">at</span> ${object.modified_at.hour}:${object.modified_at.minute}:${object.modified_at.second} <span i18n:translate="">by its working group</span>
    </span>
  <div tal:condition="'proposal' in request.content_to_support and 'published' in object.state" class="proposal-support pull-right">
    <span class="label success">
        <span tal:condition="any(t.owner is current_user for t in object.tokens_support)" 
              class="hidden-xs glyphicon glyphicon-hand-down my-token-success"> </span>
        <span class="token token-success glyphicon glyphicon-thumbs-up"></span>
        <span class="support-nb">${len(object.tokens_support)}</span>
    </span>
    <span class="label danger">
        <span tal:condition="any(t.owner is current_user for t in object.tokens_opposition)" 
              class="hidden-xs glyphicon glyphicon-hand-down my-token-danger"> </span>
        <span class="token token-danger glyphicon glyphicon-thumbs-down"></span>
        <span class="support-nb">${len(object.tokens_opposition)}</span>
    </span>
  </div>
  <div tal:condition="'proposal' in request.content_to_examine and  'examined' in object.state" class="proposal-opinion pull-right"  title="${object.opinion_value}" >
      <div class="proposal-explanation hide-bloc">
        <button type="button" class="close" data-dismiss="proposal-explanation"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
         ${structure:object.opinion['explanation']}</div>
      <div class="circle red ${(object.opinion['opinion'] != 'unfavorable') and 'off' or 'on' }"></div>
      <div class="circle orange ${(object.opinion['opinion'] != 'to_study') and 'off' or 'on' }"></div>
      <div class="circle green ${(object.opinion['opinion'] != 'favorable') and 'off' or 'on'}"></div>
  </div>
  </div>
</div>
